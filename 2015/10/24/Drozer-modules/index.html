<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>实战Drozer模块编写 | MS509 Team</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">实战Drozer模块编写</h1><a id="logo" href="/.">MS509 Team</a><p class="description">Mission Studio</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/contact/"><i class="fa fa-comments"> 联系</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">实战Drozer模块编写</h1><div class="post-meta">2015-10-24<span> | </span><span class="category"><a href="/categories/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/">移动安全</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 4k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 18</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>作者: thor</p>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>drozer是MWR Labs开发的一款Android安全测试框架。是目前最好的Android安全测试工具之一。drozer提供了命令行交互式界面，使用drozer进行安全测试，用户在自己的console端输入命令，drozer会将命令发送到Android设备上的drozer agent代理程序执行。drozer采用了模块化的设计，用户可以定制开发需要的测试模块。编写drozer模块主要涉及python模块及dex模块。python模块在drozer console端运行，类似于metasploit中的插件，可以扩展drozer console的测试功能。dex模块是java编写的android代码，类似于android的dex插件，在android手机上运行，用于扩展drozer agent的功能。</p>
<h2 id="0x00-简单的drozer模块demo代码"><a href="#0x00-简单的drozer模块demo代码" class="headerlink" title="0x00 简单的drozer模块demo代码"></a>0x00 简单的drozer模块demo代码</h2><p>首先看看drozer wiki给出的demo，该模块的功能就是在android设备上反射调用java.util.Random类生成一个随机数并返回：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from drozer.modules import Module</span><br><span class="line"></span><br><span class="line">	class GetInteger(Module):</span><br><span class="line">	</span><br><span class="line">	    name &#x3D; &quot;&quot;</span><br><span class="line">	    description &#x3D; &quot;&quot;</span><br><span class="line">	    examples &#x3D; &quot;&quot;</span><br><span class="line">	    author &#x3D; &quot;Joe Bloggs (@jbloggs)&quot;</span><br><span class="line">	    date &#x3D; &quot;2012-12-21&quot;</span><br><span class="line">	    license &#x3D; &quot;BSD (3-clause)&quot;</span><br><span class="line">	    path &#x3D; [&quot;exp&quot;, &quot;test&quot;]</span><br><span class="line">	</span><br><span class="line">	    def execute(self, arguments):</span><br><span class="line">	        random &#x3D; self.new(&quot;java.util.Random&quot;)</span><br><span class="line">	        integer &#x3D; random.nextInt()</span><br><span class="line">	</span><br><span class="line">	        self.stdout.write(&quot;int: %d\n&quot; % integer)</span><br></pre></td></tr></table></figure>
<p>GetInteger类就是一个简单的drozer模块，它继承自drozer提供的模块基类Module。每个继承了Module的类都对应着一个drozer模块，模块具体实现的功能则是在类中重写excute函数，实现新的功能。在drozer console中执行以下命令就可以运行该模块了：  </p>
<p><code>dz&gt; run exp.test.getinteger</code></p>
<p>运行效果如下：   </p>
<p><img src="/2015/10/24/Drozer-modules/1.png" alt="1"></p>
<p>drozer 通过Module类的metadata来配置和管理每个模块,因此模块编写时需要包含以下 metadata信息:        </p>
<pre><code>name          模块的名称
description   模块的功能描述 
examples      模块的使用示例
author        作者
date          日期
license       许可
path          描述模块命令空间</code></pre><p>这些信息中比较重要的就是path变量，它描述了模块在drozer namespace中的路径，结合对应的classname可以唯一确定drozer中的模块。例如demo中的path = [“exp”, “test”],类名为GetInteger，那么在drozer console中该模块就以exp.test.getinteger唯一确定。需要注意的是，尽管类的名字有大小写之分，但运行该模块的时候，drozer console中的名字都为小写。</p>
<h2 id="0x01-drozer模块仓库的创建及模块安装"><a href="#0x01-drozer模块仓库的创建及模块安装" class="headerlink" title="0x01 drozer模块仓库的创建及模块安装"></a>0x01 drozer模块仓库的创建及模块安装</h2><p>drozer模块安装有两种方法，一种是直接在repository中按照python包管理的方法新建目录结构，将python文件放入相应目录中，另一种是在drozer console中通过module install命令直接安装模块。</p>
<p>这两种方法都必须先在本地创建一个drozer 的repository目录，可以直接在drozer console中通过命令创建：</p>
<p> <code>dz&gt; module repository create [/path/to/repository]</code></p>
<p>也可以在~/.drozer_config文件中指定本地repository目录</p>
<pre><code>[repositories]    
/path/to/repository  =  /path/to/repository</code></pre><p>创建好本地repository后就可以安装自己的模块了。两种安装方法：</p>
<p>1) 按照python包管理的方式，在本地repository目录下创建目录exp,新建__int__.py空白文件，然后将Python模块源码放入exp目录即可。例如将test.py放入exp目录下，test.py的内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	from drozer.modules import Module</span><br><span class="line"></span><br><span class="line">class GetInteger(Module):</span><br><span class="line"></span><br><span class="line">    name &#x3D; &quot;&quot;</span><br><span class="line">    description &#x3D; &quot;&quot;</span><br><span class="line">    examples &#x3D; &quot;&quot;</span><br><span class="line">    author &#x3D; &quot;Joe Bloggs (@jbloggs)&quot;</span><br><span class="line">    date &#x3D; &quot;2012-12-21&quot;</span><br><span class="line">    license &#x3D; &quot;BSD (3-clause)&quot;</span><br><span class="line">    path &#x3D; [&quot;exp&quot;, &quot;test&quot;]</span><br><span class="line"></span><br><span class="line">    def execute(self, arguments):</span><br><span class="line">        random &#x3D; self.new(&quot;java.util.Random&quot;)</span><br><span class="line">        integer &#x3D; random.nextInt()</span><br><span class="line"></span><br><span class="line">        self.stdout.write(&quot;int: %d\n&quot; % integer)</span><br></pre></td></tr></table></figure>

<p>安装好模块之后即可在drozer console端通过命令run exp.test.getinteger运行该模块了。</p>
<p>2) 通过drozer console中的命令module install 安装。首先将编辑好的python模块源文件命名为 exp.test2,文件的内容同上。在drozer console中执行   </p>
<p><code>dz&gt; module install  [/path/to/exp.test2]</code>      </p>
<p>执行成功后则可以在本地repository目录下exp目录中看到生成了test2.py文件，内容和原来的exp.test2文件一致。安装成功后及可执行该模块了。module install除了可以安装本地仓库的模块外，还可以远程安装gitbub上的模块，地址为    </p>
<pre><code>https://raw.github.com/mwrlabs/drozer-modules/repository/</code></pre><p>例如运行</p>
<p><code>dz&gt;module install jubax.javascript</code></p>
<p>将远程下载并安装scanner.misc.checkjavascriptbridge模块，安装完成后执行</p>
<p><code>dz&gt; run scanner.misc.checkjavascriptbridge</code></p>
<p>就可以运行该模块，该模块的功能是检查webview中addJavascriptInterface的使用是否存在安全隐患。</p>
<h2 id="0x02-利用drozer提供的API扩展功能"><a href="#0x02-利用drozer提供的API扩展功能" class="headerlink" title="0x02 利用drozer提供的API扩展功能"></a>0x02 利用drozer提供的API扩展功能</h2><p>drozer封装了android中大部分API功能，使得能够在python中方便的使用这些API扩展功能，发挥drozer及python的强大威力。</p>
<p>1）利用反射直接与Dalvik虚拟机交互，其实就是Python直接在写android代码，非常简单方便。drozer主要是利用了drozer agent代理实现相关功能，实例化某个类的代码如下：   </p>
<p><code>my_object = self.new(&quot;some.package.MyClass&quot;)</code></p>
<p>例如drozer.android模块中封装了Intent类，用户可以通过如下方式构造需要的Intent：</p>
<p><code>someintent = android.Intent(action=act, category=cat, data_uri=data, component=comp, extras=extr, flags=flgs)</code></p>
<p>然后通过intent打开某个activity: </p>
<p> <code>self.getContext().startActivity(someintent)</code></p>
<p>2) drozer针对比较常用的功能还二次封装了很多python的mixins工具类，提供了更简单易用的API，这些mixins都在drozer.modules.common包中：</p>
<pre><code>Assets
BusyBox
ClassLoader
FileSystem
Filters
PackageManager
Provider
ServiceBinding
Shell
Strings
SuperUser
TableFormatter
ZipFile</code></pre><p>例如FileSystem类提供了访问android手机文件系统的接口，可以方便地读写、创建及删除andoid手机上的目录和文件。ZipFile类提供了解压zip文件的功能。<br>为了使用这些mixin类提供的功能，在模块中可以直接继承这些类就可以了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from drozer.modules import common, Module</span><br><span class="line">	</span><br><span class="line">   class MyModule(Module, common.FileSystem, common.ZipFile):</span><br><span class="line">	       ……</span><br><span class="line">	       ……</span><br><span class="line">	   self.deleteFile(“somepath”)</span><br><span class="line">              ……</span><br><span class="line">              ……</span><br><span class="line">	   dex_file &#x3D; self.extractFromZip(&quot;classes.dex&quot;, path, self.cacheDir())</span><br></pre></td></tr></table></figure>

<p>其中，self.deleteFile来自FileSystem类，self.extractFromZip来自ZipFile类。</p>
<p>##0x03 实现find port及find IP模块</p>
<p>1) app开放端口查找模块</p>
<p>Android app通常会监听某些端口进行本地IPC或者远程网络通信，但是这些暴露的端口却代表了潜在的本地或远程攻击面，具体可以参考大牛的文章：</p>
<p><a href="http://www.ms509.com/2015/07/12/android-open-port/" target="_blank" rel="noopener">浅谈Android开放网络端口的安全风险</a></p>
<p>文章中提供了查找开放端口及对应app的python脚本，我们将其重写为drozer模块，方便测试时使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">from drozer.modules import Module,common</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">class findport(Module,common.Shell):</span><br><span class="line"></span><br><span class="line">    name &#x3D; &quot;&quot;</span><br><span class="line">    description &#x3D; &quot;find open port in android&quot;</span><br><span class="line">    examples &#x3D; &quot;run exp.work.findport&quot;</span><br><span class="line">    author &#x3D; &quot;thor@ms509&quot;</span><br><span class="line">    date &#x3D; &quot;2015-12-02&quot;</span><br><span class="line">    license &#x3D; &quot;BSD (3-clause)&quot;</span><br><span class="line">    path &#x3D; [&quot;exp&quot;,&quot;work&quot;]</span><br><span class="line">    </span><br><span class="line">    def toHexPort(self,port):</span><br><span class="line">        hexport &#x3D; str(hex(int(port)))</span><br><span class="line">        return hexport.strip(&#39;0x&#39;).upper()     </span><br><span class="line">        </span><br><span class="line">    def finduid(self,protocol, entry):</span><br><span class="line">        if (protocol&#x3D;&#x3D;&#39;tcp&#39; or protocol&#x3D;&#x3D;&#39;tcp6&#39;):</span><br><span class="line">            uid &#x3D; entry.split()[-10]</span><br><span class="line"></span><br><span class="line">        else: # udp or udp6</span><br><span class="line">            uid &#x3D; entry.split()[-6]</span><br><span class="line">    </span><br><span class="line">        try: </span><br><span class="line">            uid &#x3D; int(uid)</span><br><span class="line">        except:</span><br><span class="line">            return -1 	</span><br><span class="line">        if (uid &gt; 10000): # just for non-system app</span><br><span class="line">            return &#39;u0_a&#39;+str(uid-10000) </span><br><span class="line">        else:</span><br><span class="line">            return -1</span><br><span class="line"></span><br><span class="line">    def execute(self, arguments):        </span><br><span class="line">        </span><br><span class="line">        proc_net &#x3D; &quot;&#x2F;proc&#x2F;net&#x2F;&quot;      </span><br><span class="line">        ret &#x3D; self.shellExec(&quot;netstat -anp | grep -Ei &#39;listen|udp*&#39;&quot;)</span><br><span class="line">        list_line &#x3D; ret.split(&#39;\n&#39;)</span><br><span class="line">        apps &#x3D; []</span><br><span class="line">        strip_listline &#x3D; []</span><br><span class="line">        #pattern &#x3D; re.compile(&quot;^Proto&quot;) # omit the first line</span><br><span class="line">        </span><br><span class="line">        for line in list_line:              </span><br><span class="line">                if (line !&#x3D; &#39;&#39;):               </span><br><span class="line">                   socket_entry &#x3D; line.split()</span><br><span class="line">                   protocol &#x3D; socket_entry[0]  </span><br><span class="line">                   port &#x3D; socket_entry[3].split(&#39;:&#39;)[-1]</span><br><span class="line">                   grep_appid &#x3D; &#39;grep  &#39;+ self.toHexPort(port) + &#39; &#39; + proc_net + protocol                    </span><br><span class="line">                   </span><br><span class="line">                   net_entry &#x3D; self.shellExec(grep_appid)                         </span><br><span class="line">                   uid &#x3D; self.finduid(protocol, net_entry)</span><br><span class="line">                              </span><br><span class="line">                   if (uid &#x3D;&#x3D; -1): </span><br><span class="line">                       continue</span><br><span class="line">                                 </span><br><span class="line">                   applist &#x3D; self.shellExec(&#39;ps | grep &#39; + uid).split()    </span><br><span class="line">                   app &#x3D; applist[8]</span><br><span class="line">                   apps.append(app)</span><br><span class="line">                   strip_listline.append(line)</span><br><span class="line">                   </span><br><span class="line">        itapp&#x3D; iter(apps)</span><br><span class="line">        itline&#x3D;iter(strip_listline)</span><br><span class="line">              </span><br><span class="line">        self.stdout.write(&quot;Proto  Recv-Q Send-Q  Local Address        Foreign Address        State            APP\r\n&quot;)</span><br><span class="line">        try:</span><br><span class="line">            while True:</span><br><span class="line">                self.stdout.write( itline.next() + &#39; &#39;*10 + itapp.next() + &#39;\n&#39;)</span><br><span class="line">                </span><br><span class="line">        except StopIteration:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">        self.stdout.write(&#39;\n&#39;)</span><br></pre></td></tr></table></figure>


<p> 该模块的主要功能都是在findport类中的execute函数中实现，查找开放端口及app的方法和原来文章中的一样，这里主要用到了drozer提供的common.Shell类，用于在android设备上执行shell命令：    </p>
<p><code>ret = self.shellExec(&quot;netstat -anp | grep -Ei &#39;listen|udp*&#39;&quot;)</code> </p>
<p> 在drozer console中直接运行如下命令即可：       </p>
<p>   <code>dz&gt; run exp.work.findport</code></p>
<p> 运行效果如下：<br> <img src="/2015/10/24/Drozer-modules/3.png" alt="image"></p>
<p>2）app中IP地址扫描模块</p>
<p>drozer的scanner.misc.weburls提供了扫描app中http及https URL地址的功能，仿照该模块的功能，我们实现了app中IP地址的扫描模块，这些收集到的IP地址可以在web渗透测试中使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">from pydiesel.reflection import ReflectionException</span><br><span class="line">from drozer.modules import common, Module </span><br><span class="line"></span><br><span class="line">class findips(Module, common.FileSystem, common.PackageManager, common.Provider, common.Strings, common.ZipFile):</span><br><span class="line"></span><br><span class="line">    name &#x3D; &quot;Find IPs specified in packages.&quot;</span><br><span class="line">    description &#x3D; &quot;&quot;&quot;</span><br><span class="line">    Find IPs in apk files</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    examples &#x3D; &quot;&quot;</span><br><span class="line">    author &#x3D; &quot;7h0r@ms509&quot;</span><br><span class="line">    date &#x3D; &quot;2015-12-9&quot;</span><br><span class="line">    license &#x3D; &quot;&quot;</span><br><span class="line">    path &#x3D; [&quot;exp&quot;, &quot;server&quot;]</span><br><span class="line">    permissions &#x3D; [&quot;com.mwr.dz.permissions.GET_CONTEXT&quot;]</span><br><span class="line"></span><br><span class="line">    def add_arguments(self, parser):</span><br><span class="line">        parser.add_argument(&quot;-a&quot;, &quot;--package&quot;, help&#x3D;&quot;specify a package to search&quot;)</span><br><span class="line"></span><br><span class="line">    def execute(self, arguments):</span><br><span class="line">        self.ip_matcher &#x3D; re.compile(r&quot;((?:(?:25[0-5]|2[0-4]\d|((1\d&#123;2&#125;)|([1-9]?\d)))\.)&#123;3&#125;(?:25[0-5]|2[0-4]\d|((1\d&#123;2&#125;)|([1-9]?\d))))&quot;)</span><br><span class="line">        if arguments.package !&#x3D; None:</span><br><span class="line">            self.check_package(arguments.package, arguments)</span><br><span class="line">        else:</span><br><span class="line">            for package in self.packageManager().getPackages(common.PackageManager.GET_PERMISSIONS):</span><br><span class="line">                try:</span><br><span class="line">                    self.check_package(package.packageName, arguments)</span><br><span class="line">                except Exception, e:</span><br><span class="line">                    print str(e)</span><br><span class="line"></span><br><span class="line">    def check_package(self, package, arguments):</span><br><span class="line">        self.deleteFile(&quot;&#x2F;&quot;.join([self.cacheDir(), &quot;classes.dex&quot;]))</span><br><span class="line">        ips &#x3D; []</span><br><span class="line">     </span><br><span class="line">        for path in self.packageManager().getSourcePaths(package):</span><br><span class="line">            strings &#x3D; []</span><br><span class="line">            if &quot;.apk&quot; in path:</span><br><span class="line">                dex_file &#x3D; self.extractFromZip(&quot;classes.dex&quot;, path, self.cacheDir())</span><br><span class="line">                if dex_file !&#x3D; None:</span><br><span class="line">                    strings &#x3D; self.getStrings(dex_file.getAbsolutePath())</span><br><span class="line"></span><br><span class="line">                    dex_file.delete()</span><br><span class="line">                    strings +&#x3D; self.getStrings(path.replace(&quot;.apk&quot;, &quot;.odex&quot;)) </span><br><span class="line">            elif (&quot;.odex&quot; in path):</span><br><span class="line">                strings &#x3D; self.getStrings(path)</span><br><span class="line">            else:</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">            for s in strings:</span><br><span class="line">                m &#x3D; self.ip_matcher.search(s)</span><br><span class="line">                if m is not None:</span><br><span class="line">                    ips.append(s)</span><br><span class="line">                   </span><br><span class="line">            if len(ips) &gt; 0:</span><br><span class="line">                self.stdout.write(&quot;%s\n&quot; % str(package))</span><br><span class="line"></span><br><span class="line">            for ip in ips:</span><br><span class="line">                    self.stdout.write(&quot;  %s\n&quot; % ip)</span><br><span class="line"></span><br><span class="line">            if len(ips) &gt; 0 :</span><br><span class="line">                self.stdout.write(&quot;\n&quot;)</span><br></pre></td></tr></table></figure>



<p><code>add_arguments</code>函数是drozer提供的接口，用于添加命令行参数，这里我们添加了–package参数，用于指定app名称，如果没有指定–package参数，那么默认会查找所有app中的IP地址，比较耗时。check_package函数主要实现指定app扫描IP地址的功能，该函数首先从app相关目录中查找apk文件、odex文件，如果是apk文件则从apk文件中解压出classes.dex文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for path in self.packageManager().getSourcePaths(package):</span><br><span class="line">	strings &#x3D; []</span><br><span class="line">	if &quot;.apk&quot; in path:</span><br><span class="line">	    dex_file &#x3D; self.extractFromZip(&quot;classes.dex&quot;, path, self.cacheDir())</span><br></pre></td></tr></table></figure>


<p>然后从得到的dex、odex文件中获取到所有的strings:</p>
<p><code>strings = self.getStrings(path)</code></p>
<p>这里的getStrings是drozer提供的API，实现了类似linux下strings命令的功能。</p>
<p>找到app中的所有strings后再用re匹配得到相应的IP地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for s in strings:</span><br><span class="line">       m &#x3D; self.ip_matcher.search(s)</span><br><span class="line">       if m is not None:</span><br><span class="line">           ips.append(s)</span><br></pre></td></tr></table></figure>

<p>ip_matcher的正则表达式为：</p>
<p><code>self.ip_matcher = re.compile(r&quot;((?:(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d))))&quot;)</code></p>
<p>最后，在drozer console中通过如下命令运行该模块：</p>
<p><code>dz&gt; run exp.server.findips -a com.dianping.v1</code></p>
<p>运行效果如下所示：</p>
<p><img src="/2015/10/24/Drozer-modules/4.png" alt="image"></p>
<h2 id="0x04-编写dex插件"><a href="#0x04-编写dex插件" class="headerlink" title="0x04 编写dex插件"></a>0x04 编写dex插件</h2><p>除了利用drozer以python代码形式提供的API，用户还可以用java代码编写dex插件。<br>例如下面的java代码就可以编译为drozer的dex插件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">import android.util.Base64;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line">import android.net.Uri;</span><br><span class="line">import android.content.ContentResolver;</span><br><span class="line">import android.database.Cursor;</span><br><span class="line">import android.provider.ContactsContract;</span><br><span class="line">import android.content.Context;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class dextest &#123;</span><br><span class="line"></span><br><span class="line">  private static final int BUFFER_SIZE &#x3D; 4096;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static String test(Context c, String number) &#123;</span><br><span class="line"></span><br><span class="line">    		String name &#x3D; null;</span><br><span class="line">			Uri uri &#x3D; Uri.parse(&quot;content:&#x2F;&#x2F;com.android.contacts&#x2F;data&#x2F;phones&#x2F;filter&#x2F;&quot; + number);</span><br><span class="line">			ContentResolver resolver &#x3D; c.getContentResolver();</span><br><span class="line">			Cursor cursor &#x3D; resolver.query(uri, new String[]&#123;android.provider.ContactsContract.Data.DISPLAY_NAME&#125;, null, null, null);</span><br><span class="line">			if (cursor.moveToFirst()) &#123;</span><br><span class="line">			    name &#x3D; cursor.getString(0);</span><br><span class="line">			    Log.d(&quot;drozer&quot;, name);</span><br><span class="line">		    &#125;</span><br><span class="line">		    cursor.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         Log.d(&quot;drozer&quot;,&quot;this is a drozer dex module!&quot;);</span><br><span class="line">         return &quot;hello world! this is a test! &quot; + number + &quot;: &quot; + name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先我们将该java文件编译为class文件：</p>
<p> <code>javac -cp lib/android.jar dextest.java</code></p>
<p>然后用android sdk提供的dx工具将class文件转换为dex文件：</p>
<p> <code>dx  --dex --output=dextest.apk dextest*.class</code></p>
<p>最后将生成的dextest.apk文件放到drozer的modules/common目录下，在编写drozer模块时可以通过以下方式调用该dex插件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dextest &#x3D; self.loadClass(&quot;common&#x2F;dextest.apk&quot;, &quot;dextest&quot;)</span><br><span class="line">self.stdout.write(&quot;[color red]get string from dex plugin: %s  [&#x2F;color]\n&quot; % dextest.test(self.getContext(),&quot;181&quot; ) )</span><br></pre></td></tr></table></figure>

<p>该测试插件根据提供的部分电话号码去匹配手机通讯录中的联系人，并返回匹配到的联系人姓名，执行效果如下:</p>
<p><img src="/2015/10/24/Drozer-modules/2.png" alt="2"></p>
<p>dex插件是由drozer上传到android手机上加载执行，它的作用还是为drozer模块提供更方便易用的接口，扩展更多的功能。由于dex插件是Java编写的原生android代码，在执行效率上比通过反射调用更高。drozer的modules/common目录下包含了多个dex插件的源码，有兴趣的同学可以自己查看。</p>
<h2 id="0x05-drozer模块的reload及动态加载问题"><a href="#0x05-drozer模块的reload及动态加载问题" class="headerlink" title="0x05 drozer模块的reload及动态加载问题"></a>0x05 drozer模块的reload及动态加载问题</h2><p>编写drozer module难免会涉及到调试的问题，drozer console提供了debug选项，会在console中打印异常信息，但是比较麻烦的是，修改module源码后必须要重启drozer console才能生效。<br>查看drozer源码，发现drozer在debug模式下提供了reload命令，但是测试了下，在mac下并没有用，还是要重启console才能生效。仔细研究drozer loader.py的相关源码：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def all(self, base):</span><br><span class="line">	 &quot;&quot;&quot;</span><br><span class="line">	 Loads all modules from the specified module repositories, and returns a  collection of module identifiers.</span><br><span class="line">	 &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">       if(len(self.__modules) &#x3D;&#x3D; 0):</span><br><span class="line">           self.__load(base)</span><br><span class="line"></span><br><span class="line">       return sorted(self.__modules.keys())</span><br><span class="line"></span><br><span class="line">   def get(self, base, key):</span><br><span class="line">       &quot;&quot;&quot;</span><br><span class="line">       Gets a module implementation, given its identifier.</span><br><span class="line">       &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">       if(len(self.__modules) &#x3D;&#x3D; 0):</span><br><span class="line">           self.__load(base)</span><br><span class="line">       </span><br><span class="line">       return self.__modules[key]</span><br><span class="line"></span><br><span class="line">   def reload(self):</span><br><span class="line">       self.__modules &#x3D; &#123;&#125;</span><br></pre></td></tr></table></figure>


<p>reload命令将self.__modules置为空，在get中按理说就会重新加载所有的drozer模块。但是在mac下始终无法实现该功能，其他平台未做测试。这里就涉及到python模块的import及reload机制问题，在网上查找到python的reload机制一些解释：</p>
<p>reload会重新加载已加载的模块，但原来已经使用的实例还是会使用旧的模块， 而新生产的实例会使用新的模块, reload后还是用原来的内存地址；不能支持from。。import。。格式的模块进行重新加载。</p>
<pre><code>http://blog.csdn.net/five3/article/details/7762870</code></pre><p>猜测可能就是这个问题，虽然用python的reload机制可以重新加载模块，但是以前使用的模块可能还是在使用中，导致修改的源码没有生效。<br>为什么不在执行时动态加载模块呢？这样可以保证加载的模块源码是最新的。<br>分析了drozer相关的所有源码，终于在session.py中找到实例化模块类的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">def __module(self, key):</span><br><span class="line">   &quot;&quot;&quot;</span><br><span class="line">   Gets a module instance, by identifier, and initialises it with the</span><br><span class="line">   required session parameters.</span><br><span class="line">   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">   module &#x3D; None</span><br><span class="line"></span><br><span class="line">   try:</span><br><span class="line">       module &#x3D; self.modules.get(self.__module_name(key))</span><br><span class="line">   except KeyError:</span><br><span class="line">       pass</span><br><span class="line"></span><br><span class="line">   if module &#x3D;&#x3D; None:</span><br><span class="line">       try:</span><br><span class="line">           module &#x3D; self.modules.get(key)</span><br><span class="line">       except KeyError:</span><br><span class="line">           pass</span><br><span class="line"></span><br><span class="line">   if module &#x3D;&#x3D; None:</span><br><span class="line">       raise KeyError(key)</span><br><span class="line">   else:</span><br><span class="line">       return module(self)</span><br></pre></td></tr></table></figure>

<p>该函数的功能就是根据模块类的key实例化该模块，从而运行该模块。因此，我们可以在这里实现动态加载要运行的模块类，放弃已经加载的模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">def __module(self, key):</span><br><span class="line"></span><br><span class="line">   &quot;&quot;&quot;</span><br><span class="line">   Gets a module instance, by identifier, and initialises it with the</span><br><span class="line">   required session parameters.</span><br><span class="line">   &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">   module &#x3D; None</span><br><span class="line"></span><br><span class="line">   try:</span><br><span class="line">       module &#x3D; self.modules.get(self.__module_name(key))</span><br><span class="line">   except KeyError:</span><br><span class="line">       pass</span><br><span class="line"></span><br><span class="line">   if module &#x3D;&#x3D; None:</span><br><span class="line">       try:</span><br><span class="line">           module &#x3D; self.modules.get(key)</span><br><span class="line">       except KeyError:</span><br><span class="line">           pass</span><br><span class="line"></span><br><span class="line">   if module &#x3D;&#x3D; None:</span><br><span class="line">       raise KeyError(key)</span><br><span class="line">   else:</span><br><span class="line"></span><br><span class="line">       #reload module</span><br><span class="line">       mod &#x3D; reload(sys.modules[module.__module__])</span><br><span class="line">       </span><br><span class="line">       module_class_name &#x3D; module.__name__</span><br><span class="line">       module_class &#x3D; getattr(mod,module_class_name)  #get module class object</span><br><span class="line">       return module_class(self)</span><br></pre></td></tr></table></figure>

<p>关键的代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#reload module   </span><br><span class="line">mod &#x3D; reload(sys.modules[module.__module__])</span><br><span class="line"></span><br><span class="line">module_class_name &#x3D; module.__name__</span><br><span class="line">module_class &#x3D; getattr(mod,module_class_name)  #get module class object</span><br><span class="line">return module_class(self)</span><br></pre></td></tr></table></figure>

<p>首先使用python的reload函数重新加载指定的模块，然后再在重新加载的模块中查找到drozer模块关联的类，最后实例化并返回。只需添加几行代码便可实现动态加载模块类，这样调试的时候就不用每次重启drozer console了。这里只是提供了一种简单的实现动态加载模块的方法，主要是方便模块的编写及测试。</p>
</div><div class="tags"><a href="/tags/Android/"><i class="fa fa-tag"></i>Android</a></div><div class="post-nav"><a class="pre" href="/2016/01/22/glibc-heap-ctf-writeup/">glibc堆溢出学习笔记（兼2015强网杯shellman writeup)</a><a class="next" href="/2015/07/12/android-open-port/">浅谈Android开放网络端口的安全风险</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB%E5%AE%89%E5%85%A8/">WEB安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8/">二进制安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/">信息收集</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">内网渗透</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/">安全工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/">社会工程学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/">移动安全</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/%E7%99%BB%E9%99%86%E5%87%AD%E8%AF%81/" style="font-size: 15px;">登陆凭证</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/%E5%8E%9F%E5%88%9B%E6%BC%8F%E6%B4%9E/" style="font-size: 15px;">原创漏洞</a> <a href="/tags/CMS/" style="font-size: 15px;">CMS</a> <a href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" style="font-size: 15px;">内网穿透</a> <a href="/tags/JAVA/" style="font-size: 15px;">JAVA</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/PWN/" style="font-size: 15px;">PWN</a> <a href="/tags/WAF%E7%BB%95%E8%BF%87/" style="font-size: 15px;">WAF绕过</a> <a href="/tags/Window/" style="font-size: 15px;">Window</a> <a href="/tags/%E6%9D%80%E6%AF%92%E8%BD%AF%E4%BB%B6/" style="font-size: 15px;">杀毒软件</a> <a href="/tags/Cknife/" style="font-size: 15px;">Cknife</a> <a href="/tags/%E5%AE%A1%E8%AE%A1%E5%B7%A5%E5%85%B7/" style="font-size: 15px;">审计工具</a> <a href="/tags/%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">恶意程序</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/IOS/" style="font-size: 15px;">IOS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/07/13/MysqlLogMonitor/">【工具开源】MysqlSql语句监控工具——MysqlLogMonitor</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/29/Dsmall-Code-Audit/">DSMall的那些洞，你能发现吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/24/Waf-Bypass-Sql/">WAF绕过奇技淫巧之SQL注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/17/Collect-login-credentials/">linux后渗透之收集登录凭证</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/17/Intranet-penetration/">内网渗透之内网穿透</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/27/Subrion-Cms-Code-Audit/">Subrion CMS 代码审计</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/19/Java-Debug/">Java无源码调试之英雄崛起</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/27/CVE-2017-8890-smep-bypass/">CVE-2017-8890实现linux内核提权- SMEP绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/27/CVE-2017-8890-kernel-escalation1/">利用CVE-2017-8890实现linux内核提权- ret2usr</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/03/bundle-mismatch/">Bundle风水——Android序列化与反序列化不匹配漏洞详解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.zerokeeper.com/" title="小李飞刀" target="_blank">小李飞刀</a><ul></ul><a href="http://cybersec.blog.51cto.com" title="网络空间安全的道与术" target="_blank">网络空间安全的道与术</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">MS509 Team.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>